<div class="row">
  <div class="col col-md-12">
    <p class="total-items"><b>Total appointments: {{count}}</b></p>
    <div class="card">
      <div class="card-block table-appointment">
        <table class="table">
          <thead>
            <tr>
              <th>
                <a (click)="sortBy('tutorId', 'desc')" translate>Tutor name</a>
                <span *ngIf="sortOption.sortBy=='tutorId'">
                  <a (click)="sortBy('tutorId', 'asc')" *ngIf="sortOption.sortType=='desc'"
                    ><i class="fa fa-caret-down"></i
                  ></a>
                  <a (click)="sortBy('tutorId', 'desc')" *ngIf="sortOption.sortType=='asc'"
                    ><i class="fa fa-caret-up"></i
                  ></a>
                </span>
              </th>
              <th>
                <a (click)="sortBy('userId', 'desc')" translate>User name</a>
                <span *ngIf="sortOption.sortBy=='userId'">
                  <a (click)="sortBy('userId', 'asc')" *ngIf="sortOption.sortType=='desc'"
                    ><i class="fa fa-caret-down"></i
                  ></a>
                  <a (click)="sortBy('userId', 'desc')" *ngIf="sortOption.sortType=='asc'"
                    ><i class="fa fa-caret-up"></i
                  ></a>
                </span>
              </th>
              <th>
                <a (click)="sortBy('webinarId', 'desc')" translate>Group Class</a>
                <span *ngIf="sortOption.sortBy=='webinarId'">
                  <a (click)="sortBy('webinarId', 'asc')" *ngIf="sortOption.sortType=='desc'"
                    ><i class="fa fa-caret-down"></i
                  ></a>
                  <a (click)="sortBy('webinarId', 'desc')" *ngIf="sortOption.sortType=='asc'"
                    ><i class="fa fa-caret-up"></i
                  ></a>
                </span>
              </th>
              <th>
                <a (click)="sortBy('webinarId', 'desc')" translate>Subject</a>
                <span *ngIf="sortOption.sortBy=='webinarId'">
                  <a (click)="sortBy('webinarId', 'asc')" *ngIf="sortOption.sortType=='desc'"
                    ><i class="fa fa-caret-down"></i
                  ></a>
                  <a (click)="sortBy('webinarId', 'desc')" *ngIf="sortOption.sortType=='asc'"
                    ><i class="fa fa-caret-up"></i
                  ></a>
                </span>
              </th>
              <th>
                <a (click)="sortBy('type', 'desc')" translate>Enroll type</a>
                <span *ngIf="sortOption.sortBy=='type'">
                  <a (click)="sortBy('type', 'asc')" *ngIf="sortOption.sortType=='desc'"
                    ><i class="fa fa-caret-down"></i
                  ></a>
                  <a (click)="sortBy('type', 'desc')" *ngIf="sortOption.sortType=='asc'"
                    ><i class="fa fa-caret-up"></i
                  ></a>
                </span>
              </th>
              <th>
                <a (click)="sortBy('paid', 'desc')" translate>Paid</a>
                <span *ngIf="sortOption.sortBy=='paid'">
                  <a (click)="sortBy('paid', 'asc')" *ngIf="sortOption.sortType=='desc'"
                    ><i class="fa fa-caret-down"></i
                  ></a>
                  <a (click)="sortBy('paid', 'desc')" *ngIf="sortOption.sortType=='asc'"
                    ><i class="fa fa-caret-up"></i
                  ></a>
                </span>
              </th>
              <th>
                <a (click)="sortBy('startTime', 'desc')" translate>Start time</a>
                <span *ngIf="sortOption.sortBy=='startTime'">
                  <a (click)="sortBy('startTime', 'asc')" *ngIf="sortOption.sortType=='desc'"
                    ><i class="fa fa-caret-down"></i
                  ></a>
                  <a (click)="sortBy('startTime', 'desc')" *ngIf="sortOption.sortType=='asc'"
                    ><i class="fa fa-caret-up"></i
                  ></a>
                </span>
              </th>
              <th>
                <a (click)="sortBy('toTime', 'desc')" translate>To time</a>
                <span *ngIf="sortOption.sortBy=='toTime'">
                  <a (click)="sortBy('toTime', 'asc')" *ngIf="sortOption.sortType=='desc'"
                    ><i class="fa fa-caret-down"></i
                  ></a>
                  <a (click)="sortBy('toTime', 'desc')" *ngIf="sortOption.sortType=='asc'"
                    ><i class="fa fa-caret-up"></i
                  ></a>
                </span>
              </th>
              <th>
                <a (click)="sortBy('createdAt', 'desc')" translate>Created at</a>
                <span *ngIf="sortOption.sortBy=='createdAt'">
                  <a (click)="sortBy('createdAt', 'asc')" *ngIf="sortOption.sortType=='desc'"
                    ><i class="fa fa-caret-down"></i
                  ></a>
                  <a (click)="sortBy('createdAt', 'desc')" *ngIf="sortOption.sortType=='asc'"
                    ><i class="fa fa-caret-up"></i
                  ></a>
                </span>
              </th>
              <th>
                <a (click)="sortBy('status', 'desc')" translate>Status</a>
                <span *ngIf="sortOption.sortBy=='status'">
                  <a (click)="sortBy('status', 'asc')" *ngIf="sortOption.sortType=='desc'"
                    ><i class="fa fa-caret-down"></i
                  ></a>
                  <a (click)="sortBy('status', 'desc')" *ngIf="sortOption.sortType=='asc'"
                    ><i class="fa fa-caret-up"></i
                  ></a>
                </span>
              </th>
            </tr>
            <tr>
              <td>
                <input
                  id="typeahead-template"
                  type="text"
                  class="form-control"
                  [(ngModel)]="tutorId"
                  [ngbTypeahead]="search"
                  [resultTemplate]="rt"
                  [inputFormatter]="formatter"
                  (keyup)="onKeyup('tutorId')"
                  placeholder="Search tutor"
                />
                <ng-template #rt let-r="result" let-t="term">
                  <ngb-highlight [result]="r.name" [term]="t">{{r?.name}}</ngb-highlight>
                </ng-template>
              </td>
              <td>
                <input
                  id="typeahead-template"
                  type="text"
                  class="form-control"
                  [(ngModel)]="userId"
                  [ngbTypeahead]="search"
                  [resultTemplate]="rt"
                  [inputFormatter]="formatter"
                  (keyup)="onKeyup('userId')"
                  placeholder="Search user"
                />
                <ng-template #rt let-r="result" let-t="term">
                  <ngb-highlight [result]="r.name" [term]="t">{{r?.name}}</ngb-highlight>
                </ng-template>
              </td>
              <td colspan="3"></td>
              <td colspan="3">
                <datepicker-range (dateChange)="dateChangeEvent($event)"></datepicker-range>
              </td>
              <td></td>
              <td>
                <select class="form-control" [(ngModel)]="searchFields.status">
                  <option value="" selected disabled translate>Choose status</option>
                  <option value="" translate>All status</option>
                  <option value="pending" translate>Pending</option>
                  <option value="canceled" translate>Canceled</option>
                  <option value="progressing" translate>In Progress</option>
                  <option value="completed" translate>Completed</option>
                  <option value="not-start" translate>Not start</option>
                </select>
              </td>
              <td>
                <button class="btn btn-primary" (click)="query()">Filter</button>
              </td>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of items, let i = index">
              <td>{{item?.tutor?.name}}</td>
              <td>{{item?.user?.name}}</td>
              <td>{{item?.webinar?.name}}</td>
              <td>{{item?.subject?.name}}</td>
              <td>
                <span class="badge badge-success" *ngIf="item?.targetType === 'webinar'" translate>Group Class</span>
                <span class="badge badge-primary" *ngIf="item?.targetType === 'subject'" translate>1 vs 1</span>
              </td>
              <td>
                <span class="badge badge-success" *ngIf="item?.paid">Yes</span>
                <span class="badge badge-danger" *ngIf="!item?.paid">No</span>
              </td>
              <td>{{item?.startTime | date:'short'}}</td>
              <td>{{item?.toTime | date:'short'}}</td>
              <td>
                <span>{{item?.createdAt | date}}</span>
              </td>
              <td>
                <appointment-status [status]="item.status"></appointment-status>
              </td>
              <td>
                <a [routerLink]="['/appointment/detail', item._id ]">
                  <i class="fa fa-eye"></i>
                </a>
                <app-ngbd-modal-component
                  *ngIf="item.status != 'canceled' && item.status != 'completed'&& item.status != 'not-start'"
                  [appoinment]="item"
                  (afterCancel)="cancelEvent($event, i)"
                ></app-ngbd-modal-component>
              </td>
            </tr>
          </tbody>
          <tfoot>
            <tr *ngIf="count > pageSize">
              <td colspan="7">
                <ngb-pagination
                  [collectionSize]="count"
                  [(page)]="currentPage"
                  [pageSize]="pageSize"
                  [maxSize]="5"
                  (pageChange)="query()"
                ></ngb-pagination>
              </td>
            </tr>
          </tfoot>
        </table>
      </div>
    </div>
  </div>
</div>
